<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì ì‹¬ ë©”ë‰´ ì¶”ì²œ</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f9fafb;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #ff6b6b;
            padding: 20px;
            color: white;
            font-size: 1.8em;
            font-weight: bold;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        #result {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0px 4px 12px rgba(0,0,0,0.1);
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
        }
        button {
            background-color: #4cafef;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s;
        }
        button:hover {
            background-color: #3498db;
        }
        #map {
            width: 100%;
            height: 500px;
            margin-top: 20px;
            border-radius: 15px;
            box-shadow: 0px 4px 12px rgba(0,0,0,0.1);
        }
    </style>
    <!-- ì¹´ì¹´ì˜¤ ì§€ë„ API (JavaScript í‚¤ ì…ë ¥) -->
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=44c6a5940878182f11e8a1a52bd5eeed&libraries=services"></script>
</head>
<body>
    <header>ğŸœ ì ì‹¬ ë©”ë‰´ ì¶”ì²œ</header>
    <div class="container">
        <button onclick="recommendMenu()">ì˜¤ëŠ˜ ë©”ë‰´ ì¶”ì²œë°›ê¸°</button>
        <div id="result">ë²„íŠ¼ì„ ëˆŒëŸ¬ ë©”ë‰´ë¥¼ ì¶”ì²œë°›ì•„ë³´ì„¸ìš”!</div>
        <div id="map"></div>
    </div>

    <script>
        const menus = ["í•˜ë£¨ë®ë°¥", "ëª¨ë°€ì—”ì¹´ì¸ ", "ë°±ìš´ë©´", "ë°±ê°œì¥", "ë¡¯ë°ë¦¬ì•„", "ë´„", "ìˆ˜ìœ ë¦¬"];
        let map, ps, markers = [];
        let currentPosition = { lat: 37.580282, lng: 127.088470 }; // ì‚¬ê°€ì •ì—­ ê¸°ë³¸ ì¢Œí‘œ

        // ì§€ë„ ì´ˆê¸°í™”
        function initMap(lat, lng) {
            map = new kakao.maps.Map(document.getElementById("map"), {
                center: new kakao.maps.LatLng(lat, lng),
                level: 4
            });

            // ì§€ë„ì— ì»¨íŠ¸ë¡¤ ì¶”ê°€ (í™•ëŒ€/ì¶•ì†Œ + ì§€ë„/ìŠ¤ì¹´ì´ë·°)
            const zoomControl = new kakao.maps.ZoomControl();
            map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);

            const mapTypeControl = new kakao.maps.MapTypeControl();
            map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);

            ps = new kakao.maps.services.Places();
        }

        // í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸° (ê°€ëŠ¥í•˜ë©´)
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (pos) {
                    currentPosition = {
                        lat: pos.coords.latitude,
                        lng: pos.coords.longitude
                    };
                    initMap(currentPosition.lat, currentPosition.lng);
                }, function () {
                    initMap(currentPosition.lat, currentPosition.lng);
                });
            } else {
                initMap(currentPosition.lat, currentPosition.lng);
            }
        }

        // ë©”ë‰´ ì¶”ì²œ ë° ê²€ìƒ‰
        function recommendMenu() {
            const choice = menus[Math.floor(Math.random() * menus.length)];
            document.getElementById("result").innerHTML = `ì˜¤ëŠ˜ì€ <span style="color:#ff6b6b;">${choice}</span> ì–´ë•Œìš”? ğŸ½`;
            searchPlaces(choice);
        }

        // ì¥ì†Œ ê²€ìƒ‰
        function searchPlaces(keyword) {
            const searchOption = {
                location: new kakao.maps.LatLng(currentPosition.lat, currentPosition.lng),
                radius: 1000
            };
            ps.keywordSearch(keyword, placesSearchCB, searchOption);
        }

        // ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
        function placesSearchCB(data, status) {
            if (status === kakao.maps.services.Status.OK) {
                // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
                markers.forEach(marker => marker.setMap(null));
                markers = [];

                const bounds = new kakao.maps.LatLngBounds();

                data.forEach(place => {
                    displayMarker(place);
                    bounds.extend(new kakao.maps.LatLng(place.y, place.x));
                });

                // ì§€ë„ ë²”ìœ„ë¥¼ ê²€ìƒ‰ ê²°ê³¼ì— ë§ê²Œ ì¡°ì •
                map.setBounds(bounds);
            } else {
                document.getElementById("result").innerHTML = "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤ ğŸ˜¢";
            }
        }

        // ë§ˆì»¤ + ì¸í¬ìœˆë„ìš°
        function displayMarker(place) {
            const marker = new kakao.maps.Marker({
                map: map,
                position: new kakao.maps.LatLng(place.y, place.x)
            });

            const content = `
                <div style="padding:5px;font-size:13px;">
                    <strong>${place.place_name}</strong><br>
                    <span>${place.address_name}</span><br>
                    <a href="${place.place_url}" target="_blank" style="color:#4cafef;">ìƒì„¸ë³´ê¸°</a>
                </div>
            `;

            const infowindow = new kakao.maps.InfoWindow({ content: content });

            kakao.maps.event.addListener(marker, 'click', function() {
                infowindow.open(map, marker);
            });

            markers.push(marker);
        }

        window.onload = getLocation;
    </script>
</body>
</html>
